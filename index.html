<!doctype html>
<html lang='en'>
	<head>
	
	</head>
	
	<body>
		Nothing to see here...
		<div id="result"></div>
		<input id="inputVal" type="text"/>
		<button onClick="addInfo()">Add Info</button>
		<button onClick="getInfo()">View Data</button>
	</body>
</html>

<!-- Register Service Worker -->
<script src="wwwroot/pouchdb-7.0.0.min.js"></script>
<script>
	   if (navigator.storage && navigator.storage.persist) {
		navigator.storage.persist().then(granted => {
		    if (granted)
			alert("Storage will not be cleared except by explicit user action");
		    else
			alert("Storage may be cleared by the UA under storage pressure.");
		});
	   } else {
		alert("navigator.storage not found!");
		alert(navigator.storage);
		alert(navigator.storage.persist);
	   }

	if('serviceWorker' in navigator) {
		alert('Service Worker Registered');
 		window.addEventListener('load', () => {
			navigator.serviceWorker.register('ServiceWorker.js', {
				scope: '/tensentric/'
			});
		});
	}

	var db = new PouchDB('test_database');
	function addInfo() {
		var inpt = document.querySelector('inputVal').value
		db.put({
			_id: 'PatientKey-Test-'+inpt,
			PrivateKey: inpt
		}).then(function(response) {
			alert('Added Success!');
		}).catch(function(err) {
			alert("ERROR:"  + err);
		});
	}

	function getInfo() {
		var inpt = document.getElementById('inputVal').value
 		db.get('PatientKey-Test-'+inpt).then(function (result) {
			alert(JSON.stringify(result));
		});
	}
	

</script>
