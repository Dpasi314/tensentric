<!doctype html>
<html lang='en'>
	<head>
	
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="mobile-web-app-capable" content="yes">
		<link rel="manifest" href="wwwroot/manifest.json">
	
		<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.2/css/bootstrap.min.css" 
			integrity="sha384-Smlep5jCw/wG7hdkwQ/Z5nLIefveQRIY9nfy6xoR1uRYBtpZgI6339F5dgvm/e9B" crossorigin="anonymous">
	
		<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" 
			integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
	
		<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" 
			integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
	
		<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.2/js/bootstrap.min.js" 
			integrity="sha384-o+RDsa0aLu++PJvFqy8fFScvbHFLtbvScb8AjopnFD+iEQ7wo/CG0xlczd+2O/em" crossorigin="anonymous"></script>
	
	</head>
	
	<body>
		<div class="container">
			<center>
			<div class="col">
				Welcome to the Tensentric Demo Site!<br/>
				<button class="btn btn-danger btn-large" onclick="testAlert()">Test Me!</button>
				<button class="btn btn-success" onclick="sendPush()">Send Push Notification</button> <br>
				<button class="btn btn-warning" name="btnAdd" id="btnAdd">Add to Homescreen</button>
			</div>
			</center>
		</div>
	
	</body>
</html>

<!-- Register Service Worker -->
<script>
	var btnAdd = document.getElementById('btnAdd');
	if('serviceWorker' in navigator) {
 		window.addEventListener('load', () => {
			navigator.serviceWorker.register('ServiceWorker.js', {
							 scope: '/tensentric/'
							});
		});
	}
	if(Notification.permission !== "granted") {
 		Notification.requestPermission(status => {
			if(status == "granted")
			{
 				alert('You gave permission for notifications!');
			}
		})
	}
		let deferredPrompt;
	
		window.addEventListener('beforeinstallprompt', (e) => {
		  alert('Before Install Prompt');
		  // Prevent Chrome 67 and earlier from automatically showing the prompt
		  e.preventDefault();
		  // Stash the event so it can be triggered later.
		  deferredPrompt = e;
		  // Update UI notify the user they can add to home screen
		  btnAdd.style.display = 'block';
		});

		btnAdd.addEventListener('click', (e) => {
		  // hide our user interface that shows our A2HS button
		  btnAdd.style.display = 'none';
		  // Show the prompt
		  deferredPrompt.prompt();
		  // Wait for the user to respond to the prompt
		  deferredPrompt.userChoice
		    .then((choiceResult) => {
		      if (choiceResult.outcome === 'accepted') {
		        console.log('User accepted the A2HS prompt');
		      } else {
		        console.log('User dismissed the A2HS prompt');
		      }
		      deferredPrompt = null;
		    });
		});

	function testAlert(){
 		alert('Testing 123');
	}

	function sendPush()
	{
	 
	 if (Notification.permission == 'granted') {
	            navigator.serviceWorker.getRegistration().then(reg => {
	                var options = {
	                    body: "Hello, World!",
	                    icon: 'wwwroot/icons/512x512.png'
	                }
	                reg.showNotification("Demo Push Notification", options);
	            });
	        }
	}
	
</script>
